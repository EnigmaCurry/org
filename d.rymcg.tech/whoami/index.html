<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.123.7">
    <meta name="generator" content="Relearn 6.0.0+tip">
    <meta name="description" content="Whoami is a very simple application, but you can learn a lot from it. After you install Traefik, whoami should be the very first application that you install. It can help you test whether or not your Traefik installation is functioning properly.
You should study the configuration of whoami, as it is used as a template for all the other apps provided by d.rymcg.tech. Because of its simplicity, it reduces the complexity of its core components.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Whoami :: book.rymcg.tech">
    <meta name="twitter:description" content="Whoami is a very simple application, but you can learn a lot from it. After you install Traefik, whoami should be the very first application that you install. It can help you test whether or not your Traefik installation is functioning properly.
You should study the configuration of whoami, as it is used as a template for all the other apps provided by d.rymcg.tech. Because of its simplicity, it reduces the complexity of its core components.">
    <meta property="og:url" content="https://book.rymcg.tech/d.rymcg.tech/whoami/index.html">
    <meta property="og:site_name" content="book.rymcg.tech">
    <meta property="og:title" content="Whoami :: book.rymcg.tech">
    <meta property="og:description" content="Whoami is a very simple application, but you can learn a lot from it. After you install Traefik, whoami should be the very first application that you install. It can help you test whether or not your Traefik installation is functioning properly.
You should study the configuration of whoami, as it is used as a template for all the other apps provided by d.rymcg.tech. Because of its simplicity, it reduces the complexity of its core components.">
    <meta property="og:locale" content="en-us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Self-hosting Docker with d.rymcg.tech">
    <meta itemprop="name" content="Whoami :: book.rymcg.tech">
    <meta itemprop="description" content="Whoami is a very simple application, but you can learn a lot from it. After you install Traefik, whoami should be the very first application that you install. It can help you test whether or not your Traefik installation is functioning properly.
You should study the configuration of whoami, as it is used as a template for all the other apps provided by d.rymcg.tech. Because of its simplicity, it reduces the complexity of its core components.">
    <meta itemprop="wordCount" content="1751">
    <title>Whoami :: book.rymcg.tech</title>
    <link href="/css/fontawesome-all.min.css?1717815449" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1717815449" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1717815449" rel="stylesheet">
    <link href="/css/auto-complete.css?1717815449" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1717815449" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1717815449" rel="stylesheet">
    <link href="/css/fonts.css?1717815449" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1717815449" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1717815449" rel="stylesheet">
    <link href="/css/theme-zen-auto.css?1717815449" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-zen-auto.css?1717815449" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/variant.css?1717815449" rel="stylesheet">
    <link href="/css/print.css?1717815449" rel="stylesheet" media="print">
    <script src="/js/variant.js?1717815449"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='https:\/\/book.rymcg.tech';
      window.index_js_url="/index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'zen-auto', 'zen-light', 'zen-dark', 'relearn-auto', 'relearn-light', 'relearn-dark', 'relearn-bright', 'neon', 'learn', 'blue', 'green', 'red' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script><link href="/css/custom.css" rel="stylesheet">

  </head>
  <body class="mobile-support html" data-url="/d.rymcg.tech/whoami/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper"><nav class="TableOfContents">
  <ul>
    <li><a href="#what-is-whoami">What is Whoami?</a></li>
    <li><a href="#quickstart">Quickstart</a></li>
    <li><a href="#features">Features</a></li>
    <li><a href="#configuration">Configuration</a>
      <ul>
        <li><a href="#default-config-file--dot-env-dist">Default config file (.env-dist)</a></li>
        <li><a href="#configure-whoami">Configure whoami</a></li>
        <li><a href="#whoami-traefik-host">WHOAMI_TRAEFIK_HOST</a></li>
        <li><a href="#sentry-authorization">Sentry authorization</a></li>
        <li><a href="#edit-the-config-file-by-hand">Edit the config file by hand</a></li>
        <li><a href="#configuration-variables">Configuration variables</a></li>
      </ul>
    </li>
    <li><a href="#install-whoami">Install whoami</a>
      <ul>
        <li><a href="#open-whoami-in-your-web-browser">Open whoami in your web browser</a></li>
        <li><a href="#view-the-logs">View the logs</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/index.html"><span itemprop="name">book.rymcg.tech</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/d.rymcg.tech/index.html"><span itemprop="name">Self-hosting Docker</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Whoami</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/d.rymcg.tech/install-traefik-proxy/index.html" title="Install Traefik Proxy (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/publishing-with-org-mode/index.html" title="Publishing with org-mode, ox-hugo, and literate programming. (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="whoami">Whoami</h1>

<p><a href="https://github.com/EnigmaCurry/d.rymcg.tech/tree/master/whoami#readme" rel="external" target="_blank">Whoami</a> is a very simple application, but you can learn a lot from it.
After you install Traefik, whoami should be the very first application
that you install. It can help you test whether or not your Traefik
installation is functioning properly.</p>
<p><strong>You should study the configuration of whoami</strong>, as it is used as a
template for all the other apps provided by d.rymcg.tech. Because of
its simplicity, it reduces the complexity of its core components.
Whoami can be a good base template for creating your own d.rymcg.tech
enabled applications.</p>

<nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-whoami">What is Whoami?</a></li>
    <li><a href="#quickstart">Quickstart</a></li>
    <li><a href="#features">Features</a></li>
    <li><a href="#configuration">Configuration</a>
      <ul>
        <li><a href="#default-config-file--dot-env-dist">Default config file (.env-dist)</a></li>
        <li><a href="#configure-whoami">Configure whoami</a></li>
        <li><a href="#whoami-traefik-host">WHOAMI_TRAEFIK_HOST</a></li>
        <li><a href="#sentry-authorization">Sentry authorization</a></li>
        <li><a href="#edit-the-config-file-by-hand">Edit the config file by hand</a></li>
        <li><a href="#configuration-variables">Configuration variables</a></li>
      </ul>
    </li>
    <li><a href="#install-whoami">Install whoami</a>
      <ul>
        <li><a href="#open-whoami-in-your-web-browser">Open whoami in your web browser</a></li>
        <li><a href="#view-the-logs">View the logs</a></li>
      </ul>
    </li>
  </ul>
</nav>



<h2 id="what-is-whoami">What is Whoami?</h2>
<p>Whoami is a web application that simply outputs the request headers
that it receives itself (reflecting them back to the requesting
client):</p>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
## Use your own whoami URL here once you install it:
curl https://whoami.example.com
</pre></code>
    </div>
</div>


<div class="box notices cstyle stdout">
    <div class="box-label">(stdout)</div>
    <div class="box-content">
        <pre>
Name: default
Hostname: 38704012c4b3
IP: 127.0.0.1
IP: ::1
IP: 172.19.0.2
RemoteAddr: 172.19.0.1:34610
GET / HTTP/1.1
Host: whoami.example.com
User-Agent: curl/7.88.1
Accept: */*
Accept-Encoding: gzip
X-Forwarded-For: 10.93.23.114
X-Forwarded-Host: whoami.example.com
X-Forwarded-Port: 443
X-Forwarded-Proto: https
X-Forwarded-Server: docker
X-Real-Ip: 10.93.23.114
</pre>
    </div>
</div>

<p>This output is useful for end-to-end testing, to verify that the
application is capable of serving requests, and that all of the
configuration is correct.</p>
<h2 id="quickstart">Quickstart</h2>
<p>Create a new config:</p>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make whoami config
</pre></code>
    </div>
</div>


<p>The first question the config asks for is <code>WHOAMI_TRAEFIK_HOST</code> which
should be the fully qualified domain name that the whoami app will use
for its URL:</p>
<div class="box notices cstyle stdout">
    <div class="box-label">(stdout)</div>
    <div class="box-content">
        <pre>
WHOAMI_TRAEFIK_HOST: Enter the whoami domain name (eg. whoami.example.com)
​: whoami.prod.rymcg.tech
</pre>
    </div>
</div>

<p>Optional authentication can be configured:</p>
<div class="box notices cstyle stdout">
    <div class="box-label">(stdout)</div>
    <div class="box-content">
        <pre>
? Do you want to enable sentry authentication in front of this app (effectively making the entire site private)?
> No
  Yes, with HTTP Basic Authentication
  Yes, with Oauth2
  Yes, with Mutual TLS (mTLS)
</pre>
    </div>
</div>

<p>For now, choose <code>No</code>, to disable authentication. We&rsquo;ll get back to
that later.</p>
<p>Install whoami:</p>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make whoami install
</pre></code>
    </div>
</div>


<p>Open whoami:</p>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make whoami open
</pre></code>
    </div>
</div>


<p>Or just open your web browser to the URL <code>https://{WHOAMI_TRAEFIK_HOST}</code></p>
<h2 id="features">Features</h2>
<p><a href="https://github.com/traefik/whoami?tab=readme-ov-file#whoami" rel="external" target="_blank">See the upstream whoami documentation and feature list here.</a></p>
<p>In addition to the features that whoami provides, there are several
features that d.rymcg.tech provides through its own configuration and
Traefik middlewares:</p>
<ul>
<li>Running multiple separately-configured instances (Instantiation).</li>
<li>Traefik sentry authorization per instance (mTLS, OAuth2, HTTP Basic auth).</li>
<li>Source IP address filtering (blocking) per instance.</li>
</ul>
<h2 id="configuration">Configuration</h2>
<h3 id="default-config-file--dot-env-dist">Default config file (.env-dist)</h3>
<p>The default configuration file is named <code>.env-dist</code>. This config file is
used as a template, which is copied whenever you configure a new
instance of the application.</p>

<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>The <code>.env-dist</code> file should not be edited normally. It should always
contain the <em>default</em> configuration. Each instance will make its own
copy of this, and it is inside the copy that you have the opportunity
to change those defaults per instance (<code>.env_{CONTEXT}_{INSTANCE}</code>).</p>
</div>
</div>
<p>Every application instance has a unique config file, and the <code>config</code>
target automatically creates one if necessary.</p>
<h3 id="configure-whoami">Configure whoami</h3>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make whoami config
</pre></code>
    </div>
</div>



<div class="box notices cstyle info">
  <div class="box-label"><i class="fa-fw fas fa-info-circle"></i> Info</div>
  <div class="box-content">

<p>The <code>config</code> target configures the specific .env file of the instance:
<code>.env_{CONTEXT}_{INSTANCE}</code>. Since we didn&rsquo;t specify an instance name,
the instance name is <code>default</code>. If your Docker context is named
<code>prod</code>, then the full instance config file is named
<code>.env_prod_default</code>.</p>
</div>
</div>

<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>You should not share the <code>.env_{CONTEXT}_{INSTANCE}</code> files. They
should not be commited to the git repository. They are listed in the
<code>.gitignore</code> file, so you should only have one copy of these files,
living on your workstation. If these configs are important to you, you
should make an encrypted backup.</p>
<p>Run <code>d make - backup-env</code> to make a GPG encrypted backup file of all
your .env files.</p>
<p>Theres nothing particularly important inside the whoami .env files,
but this is a general warning, as many apps will store their sensitive
API keys or passwords in this file.</p>
</div>
</div>
<h4 id="configure-multiple-whoami-instances">Configure multiple whoami instances</h4>

<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Most times you only need one instance of a given app, so you don&rsquo;t
need to set an instance name, and the name <code>default</code> will be used
automatically.</p>
</div>
</div>
<p>If you want to configure multiple instances, run <code>d make whoami instance</code> for each one. You can configure unique names for each
instance, and they will each have their own .env file:
<code>.env_{CONTEXT}_{INSTANCE}</code>.</p>
<p><code>d make whoami instance</code> starts a sub-shell so that all commands will
run on that instance now by default. Press <code>Ctrl-D</code> to exit the
sub-shell, and it will go back to the original default instance (named
<code>default</code>).</p>
<h3 id="whoami-traefik-host">WHOAMI_TRAEFIK_HOST</h3>
<p>The first question the config asks for is <code>WHOAMI_TRAEFIK_HOST</code> which
is the fully qualified domain name that the whoami app should use for
its URL:</p>
<div class="box notices cstyle stdout">
    <div class="box-label">(stdout)</div>
    <div class="box-content">
        <pre>
WHOAMI_TRAEFIK_HOST: Enter the whoami domain name (eg. whoami.example.com)
​: whoami.prod.rymcg.tech
</pre>
    </div>
</div>

<p>﻿
The default name uses the <code>ROOT_DOMAIN</code> variable you set as part of the
main d.rymcg.tech config, which is also named after our current Docker
context (<code>prod</code>). Realistically, the <code>WHOAMI_TRAEFIK_HOST</code> may be set
to any valid domain name, you just need to setup the DNS for it (to
point to the IP address of the Docker host).</p>
<h3 id="sentry-authorization">Sentry authorization</h3>
<p>Another question it asks you is about sentry authorization:</p>
<div class="box notices cstyle stdout">
    <div class="box-label">(stdout)</div>
    <div class="box-content">
        <pre>
? Do you want to enable sentry authorization in front of this app (effectively making the entire site private)?
> No
  Yes, with HTTP Basic Authentication
  Yes, with Oauth2
  Yes, with Mutual TLS (mTLS)
</pre>
    </div>
</div>

<p>Sentry authorization is a collection of middlewares that are deployed
in front of your application to allow specific users entry into your
app, while denying others, based on a variety of authentication
methods. <strong>It does not implement any fine-grained permissions in the
application itself</strong>, but it does filter who can come in the front
door. It provides the application with the verified username of the
authenticated clients via the <code>X-Forwarded-User</code> HTTP header. Any
application may implement additional fine-grained permissions based on
this trusted header field.</p>
<p>To configure sentry authorization, you can choose any of these
choices:</p>
<ul>
<li>If you select <code>No</code>, then sentry authorization will be turned off.
The <code>X-Forwarded-User</code> header field will always be blank. Any
client will be able to access the application without
authenticating (however the application may still perform
authentication by itself).</li>
<li>If you select <code>Yes, with HTTP Basic Authentication</code>, the
application will require all clients to enter a username/password
into a dialog presented by the web browser. Clients who enter an
incorrect username or password will not be able to view the page.
The <code>X-Forwarded-User</code> header field will be set to the username of
the authenticated user.</li>
<li>If you select <code>Yes, with OAuth2</code>, the application will require all
clients to authenticate with another OAuth2 compatible application,
which may be a self-hosted <a href="https://github.com/EnigmaCurry/d.rymcg.tech/tree/master/forgejo#readme" rel="external" target="_blank">Forgejo</a> instance, or it can be an
external service like GitHub. Access is granted only to those users
who are listed in the corresponding Traefik authorization group
that the application is configured for. The <code>X-Forwarded-User</code>
header field will be set to the email address of the user&rsquo;s
verified account.</li>
<li>If you select <code>Yes, with mTLS</code>, the application will require all
clients to authenticate with a client mTLS certificate. Access is
granted only to those certificate names that are listed in the
application&rsquo;s config. The <code>X-Forwarded-User</code> header field will be
set to the Common Name (CN) of the client certificate with the
prefix <code>CN=</code> (eg. <code>CN=client1.example.com</code>)</li>
</ul>
<h3 id="edit-the-config-file-by-hand">Edit the config file by hand</h3>
<p>Once the config script has finished, the config file may be inspected
to verify valid settings:</p>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make whoami config-edit
</pre></code>
    </div>
</div>


<p>This will automatically open the whoami config file for the current
context/instance in your default text editor (eg. set
<code>EDITOR=/usr/bin/emacs</code> in your <code>~/.bashrc</code> file), and you may make
any changes, and save the file again.</p>
<p>You can also open the file manually, the path is
<code>~/git/vendor/enigmacurry/d.rymcg.tech/whoami/.env_{CONTEXT}_{INSTANCE}</code>.</p>
<h3 id="configuration-variables">Configuration variables</h3>
<h4 id="whoami-traefik-host">WHOAMI_TRAEFIK_HOST</h4>
<p>This sets the fully qualified domain name of the application.</p>
<h4 id="whoami-instance">WHOAMI_INSTANCE</h4>
<p>This sets the name of the whoami instance. If left blank, the default
name is <code>default</code>.</p>
<h4 id="whoami-ip-sourcerange">WHOAMI_IP_SOURCERANGE</h4>
<p>This sets the acceptable IP addresses ranges for incoming requests. It
is a comma separated list of <a href="https://en.wikipedia.org/wiki/CIDR#CIDR_notation" rel="external" target="_blank">CIDR formatted netmasks</a>.</p>
<p>Here are some example settings:</p>
<ul>
<li><code>WHOAMI_IP_SOURCERANGE=0.0.0.0/0</code> - allow any access from any IP address.</li>
<li><code>WHOAMI_IP_SOURCERANGE=0.0.0.0/32</code> - allow NO access from any IP address.</li>
<li><code>WHOAMI_IP_SOURCERANGE=192.168.1.0/24,10.3.4.0/24</code> - allow access
ONLY from two different /24 networks (512 addresses in two ranges, comma separated):
<ul>
<li><code>192.168.1.0</code> to <code>192.168.1.255</code></li>
<li><code>10.3.4.0</code> to <code>10.3.4.255</code></li>
</ul>
</li>
</ul>
<h4 id="whoami-http-auth">WHOAMI_HTTP_AUTH</h4>
<p>If this is blank, sentry authorization with HTTP Basic Authentication
will be disabled (default). Otherwise, this should set the <a href="https://doc.traefik.io/traefik/middlewares/http/basicauth/" rel="external" target="_blank">Traefik
BasicAuth</a> authorized users list. Don&rsquo;t attempt to edit this field by
hand, as the syntax is very complex. Always use the <code>d make whoami config</code> tool to set it correctly.</p>
<h4 id="whoami-oauth2">WHOAMI_OAUTH2</h4>
<p>If this is blank, or set to <code>false</code>, then sentry authorization with
OAuth2 will be disabled (default). If set to <code>true</code> then it will be
enabled.</p>
<p>You must separately install <a href="https://github.com/EnigmaCurry/d.rymcg.tech/tree/master/traefik-forward-auth#readme" rel="external" target="_blank">Traefik Forward Auth</a></p>
<h4 id="whoami-oauth2-authorized-group">WHOAMI_OAUTH2_AUTHORIZED_GROUP</h4>
<p>If <code>WHOAMI_OAUTH2=true</code>, then <code>WHOAMI_OAUTH2_AUTHORIZED_GROUP</code> must be
set, which is the name of the authorization group that should be
allowed access.</p>

<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Authorization groups are set separately in the Traefik config:</p>
<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make traefik config
</pre></code>
    </div>
</div>
<ul>
<li>
<p>Choose the menu <code>Configure middleware (including auth)</code>.</p>
</li>
<li>
<p>Choose the sub-menu <code>OAuth2 sentry authorization (make sentry)</code>.</p>
</li>
<li>
<p>Create a new authorization group lists and add authorized email</p>
</li>
</ul>
<p>addresses.</p>
<ul>
<li>
<p>Reinstall Traefik</p>
</li>
<li>
<p>In the whoami config, set <code>WHOAMI_OAUTH2_AUTHORIZED_GROUP</code> to the</p>
</li>
</ul>
<p>name of the group you created.</p>
</div>
</div>
<h4 id="whoami-mtls-auth">WHOAMI_MTLS_AUTH</h4>
<p>If this is blank, or set to <code>false</code>, then sentry authorization with
mTLS will be disabled (default). If set to <code>true</code> then it will be
enabled.</p>
<h4 id="whoami-mtls-authorized-certs">WHOAMI_MTLS_AUTHORIZED_CERTS</h4>
<p>If <code>WHOAMI_MTLS_AUTH=true</code>, then <code>WHOAMI_MTLS_AUTHORIZED_CERTS</code> must
be set, which is the list of the certificates names (CN) that should
be allowed.</p>
<p>Wildcards are allowed, so a good setting could be like
<code>*.clients.example.com</code> to allow any client subdomain of
<code>clients.example.com</code>.</p>
<h2 id="install-whoami">Install whoami</h2>
<p>Once the configuration has been verified, you can install the
application:</p>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make whoami install
</pre></code>
    </div>
</div>


<h3 id="open-whoami-in-your-web-browser">Open whoami in your web browser</h3>
<p>Once installed, the application should be ready to view in your web browser:</p>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make whoami open
</pre></code>
    </div>
</div>


<p>This will automatically open your default web browser to the URL of
the installed whoami application. If you want to do so manually, just
go to the same URL as you configured for <code>WHOAMI_TRAEFIK_HOST</code>.</p>
<h3 id="view-the-logs">View the logs</h3>
<p>It may be necessary to inspect the applicaiton logs, which you can do
so as follows:</p>


<div class="box notices cstyle run">
    <div class="box-label primary">
        <i class="fa-fw fas fa-dollar-sign"></i>[bash]: Run this on your workstation:</div>
    <div class="box-content">
        <code><pre>
d make whoami logs
</pre></code>
    </div>
</div>



            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<img src="/img/logo.jpg" class="logo" />

        </div>

        <search><form action="/search.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1717815449" defer></script>
        <script src="/js/lunr/lunr.min.js?1717815449" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1717815449" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1717815449" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1717815449" defer></script>
        <script src="/js/search.js?1717815449" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <ul>
          <li><a class="padding" href="/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
        </ul>
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-topics">
          <ul class="enlarge morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/index.html" class=""><a class="padding" href="/linux-workstation/index.html">Linux Workstation</a><ul id="R-subsections-4fabcc8bf6f43bc84cc33c8d9fe1b62b" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/introduction/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/introduction/index.html">Introduction</a><ul id="R-subsections-247caeb1441bcea844a3ccf766ca4471" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/introduction/fedora-sway-atomic/index.html" class=""><a class="padding" href="/linux-workstation/introduction/fedora-sway-atomic/index.html">Fedora Sway Atomic</a></li>
          <li data-nav-id="/linux-workstation/introduction/requirements/index.html" class=""><a class="padding" href="/linux-workstation/introduction/requirements/index.html">Requirements</a></li></ul></li>
          <li data-nav-id="/linux-workstation/install/index.html" class=""><a class="padding" href="/linux-workstation/install/index.html">Install Linux (Fedora Atomic)</a></li>
          <li data-nav-id="/linux-workstation/upgrading/index.html" class=""><a class="padding" href="/linux-workstation/upgrading/index.html">Upgrading</a></li>
          <li data-nav-id="/linux-workstation/layering-packages/index.html" class=""><a class="padding" href="/linux-workstation/layering-packages/index.html">Layering packages</a></li>
          <li data-nav-id="/linux-workstation/config/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/config/index.html">Config</a><ul id="R-subsections-51edac90ba33828eb61f7465c11b4244" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/config/sway/index.html" class=""><a class="padding" href="/linux-workstation/config/sway/index.html">Sway</a></li>
          <li data-nav-id="/linux-workstation/config/firefox/index.html" class=""><a class="padding" href="/linux-workstation/config/firefox/index.html">Firefox</a></li>
          <li data-nav-id="/linux-workstation/config/toolbox/index.html" class=""><a class="padding" href="/linux-workstation/config/toolbox/index.html">Toolbox</a></li>
          <li data-nav-id="/linux-workstation/config/emacs-on-fedora/index.html" class=""><a class="padding" href="/linux-workstation/config/emacs-on-fedora/index.html">Emacs</a></li>
          <li data-nav-id="/linux-workstation/config/ssh/index.html" class=""><a class="padding" href="/linux-workstation/config/ssh/index.html">SSH</a></li></ul></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/sudo-2fa/index.html">Solokey authentication</a><ul id="R-subsections-96e2330197c57518ec319a4d358386d1" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/sudo-2fa/solo-v1/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/sudo-2fa/solo-v1/index.html">Solokey v1</a><ul id="R-subsections-e0dd1ad742e3ee0e267b4bed24caaa90" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/sudo-2fa/solo-v1/get-your-solokey/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/solo-v1/get-your-solokey/index.html">Get your Solokey (v1)</a></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/solo-v1/install-solo-cli/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/solo-v1/install-solo-cli/index.html">Install Solokey CLI (v1) tool</a></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/solo-v1/update-solokey/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/solo-v1/update-solokey/index.html">Update your Solokey (v1)</a></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/solo-v1/program-solokey/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/solo-v1/program-solokey/index.html">Program your Solokey (v1)</a></li></ul></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/sudo-2fa/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/sudo-2fa/index.html">Sudo with Solokey</a></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/ssh-2fa/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/ssh-2fa/index.html">SSH with Solokey</a></li></ul></li>
          <li data-nav-id="/linux-workstation/app-users/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/app-users/index.html">Application users</a><ul id="R-subsections-f5664fb1bd37f091399ca1d7ccc19fa6" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/app-users/digitalocean/index.html" class=""><a class="padding" href="/linux-workstation/app-users/digitalocean/index.html">DigitalOcean CLI (doctl)</a></li></ul></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/kvm-libvirt/index.html">KVM / libvirt</a><ul id="R-subsections-866ef10ce7233c8e220552c62acdd9fb" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/kvm-libvirt/install-libvirtd/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/install-libvirtd/index.html">Install libvirtd</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/setup-libvirtd/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/setup-libvirtd/index.html">Setup libvirtd</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/dedicated-vm-user/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/dedicated-vm-user/index.html">Create VM admin</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/config-vm/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/config-vm/index.html">Configure VM</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/create-vm/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/create-vm/index.html">Create VM (cloud-init)</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/systemd/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/systemd/index.html">Systemd services to control VMs</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/public-routes/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/public-routes/index.html">Public routes to VMs</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/setup-workstation/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/setup-workstation/index.html">Setup workstation SSH config</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/vm-from-iso/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/kvm-libvirt/vm-from-iso/index.html">Create VM from .iso image</a><ul id="R-subsections-fccf744633d8b11ebaec12aa36bf4834" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/kvm-libvirt/vm-from-iso/configure-vm/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/vm-from-iso/configure-vm/index.html">Configure VM with .iso boot</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/vm-from-iso/install-vm/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/vm-from-iso/install-vm/index.html">Boot VM from .iso</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/vm-from-iso/bootstrap-coreos/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/vm-from-iso/bootstrap-coreos/index.html">Bootstrap CoreOS</a></li></ul></li></ul></li></ul></li>
          <li data-nav-id="/d.rymcg.tech/index.html" class="parent "><a class="padding" href="/d.rymcg.tech/index.html">Self-hosting Docker</a><ul id="R-subsections-8a053662b5014ad6ad1762206cc0e2f9" class="morespace collapsible-menu">
          <li data-nav-id="/d.rymcg.tech/introduction/index.html" class=""><a class="padding" href="/d.rymcg.tech/introduction/index.html">Introduction</a></li>
          <li data-nav-id="/d.rymcg.tech/required-infrastructure/index.html" class="alwaysopen"><a class="padding" href="/d.rymcg.tech/required-infrastructure/index.html">Required Infrastructure</a><ul id="R-subsections-850ccad8337ba16ba7e92d565f4fea56" class="morespace collapsible-menu">
          <li data-nav-id="/d.rymcg.tech/required-infrastructure/register-a-domain-nameom/index.html" class=""><a class="padding" href="/d.rymcg.tech/required-infrastructure/register-a-domain-nameom/index.html">Register a domain name</a></li>
          <li data-nav-id="/d.rymcg.tech/required-infrastructure/setup-dns/index.html" class=""><a class="padding" href="/d.rymcg.tech/required-infrastructure/setup-dns/index.html">Setup public DNS service</a></li>
          <li data-nav-id="/d.rymcg.tech/required-infrastructure/public-docker-server/index.html" class=""><a class="padding" href="/d.rymcg.tech/required-infrastructure/public-docker-server/index.html">Create a public server (VPS)</a></li>
          <li data-nav-id="/d.rymcg.tech/required-infrastructure/private-docker-server/index.html" class=""><a class="padding" href="/d.rymcg.tech/required-infrastructure/private-docker-server/index.html">Create a private server (libvirt VM)</a></li></ul></li>
          <li data-nav-id="/d.rymcg.tech/workstation/index.html" class="alwaysopen"><a class="padding" href="/d.rymcg.tech/workstation/index.html">Setup your workstation</a><ul id="R-subsections-4a12c34b2fece93fc397ecf3de950464" class="morespace collapsible-menu">
          <li data-nav-id="/d.rymcg.tech/workstation/install-docker-command-line-tools/index.html" class=""><a class="padding" href="/d.rymcg.tech/workstation/install-docker-command-line-tools/index.html">Install Docker client tools</a></li>
          <li data-nav-id="/d.rymcg.tech/workstation/install-d-rymcg-tech/index.html" class=""><a class="padding" href="/d.rymcg.tech/workstation/install-d-rymcg-tech/index.html">Install d.rymcg.tech tools</a></li></ul></li>
          <li data-nav-id="/d.rymcg.tech/docker-context/index.html" class="alwaysopen"><a class="padding" href="/d.rymcg.tech/docker-context/index.html">Setup Docker context</a><ul id="R-subsections-0b3f5dbeb4ee162d09e37caaf65b1f43" class="morespace collapsible-menu">
          <li data-nav-id="/d.rymcg.tech/docker-context/ssh-config-and-docker-context/index.html" class=""><a class="padding" href="/d.rymcg.tech/docker-context/ssh-config-and-docker-context/index.html">Create context</a></li>
          <li data-nav-id="/d.rymcg.tech/docker-context/install-docker-on-remote-host/index.html" class=""><a class="padding" href="/d.rymcg.tech/docker-context/install-docker-on-remote-host/index.html">Install Docker</a></li>
          <li data-nav-id="/d.rymcg.tech/docker-context/main-config-for-d.rymcg/index.html" class=""><a class="padding" href="/d.rymcg.tech/docker-context/main-config-for-d.rymcg/index.html">Setup d.rymcg.tech</a></li></ul></li>
          <li data-nav-id="/d.rymcg.tech/install-traefik-proxy/index.html" class=""><a class="padding" href="/d.rymcg.tech/install-traefik-proxy/index.html">Install Traefik Proxy</a></li>
          <li data-nav-id="/d.rymcg.tech/whoami/index.html" class="active"><a class="padding" href="/d.rymcg.tech/whoami/index.html">Whoami</a></li></ul></li>
          <li data-nav-id="/publishing-with-org-mode/index.html" class=""><a class="padding" href="/publishing-with-org-mode/index.html">Publishing with org-mode</a><ul id="R-subsections-415a59a995a98556d7692b05dd8d304c" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/dependencies/index.html" class=""><a class="padding" href="/publishing-with-org-mode/dependencies/index.html">Dependencies</a></li>
          <li data-nav-id="/publishing-with-org-mode/building-locally/index.html" class=""><a class="padding" href="/publishing-with-org-mode/building-locally/index.html">Building locally</a></li>
          <li data-nav-id="/publishing-with-org-mode/publish-with-github-pages/index.html" class=""><a class="padding" href="/publishing-with-org-mode/publish-with-github-pages/index.html">Publishing with GitHub pages</a></li>
          <li data-nav-id="/publishing-with-org-mode/publish-with-sftp/index.html" class=""><a class="padding" href="/publishing-with-org-mode/publish-with-sftp/index.html">Publishing with SFTP</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/index.html" class="alwaysopen"><a class="padding" href="/publishing-with-org-mode/examples/index.html">Example Org / Hugo content</a><ul id="R-subsections-21525f33c1956ce3844918973388ff0a" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/examples/org-blocks/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/org-blocks/index.html">Example Org Blocks</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/shortcodes/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/shortcodes/index.html">Example Shortcodes</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/index.html" class="alwaysopen"><a class="padding" href="/publishing-with-org-mode/examples/deeply/index.html">Example of a deeply …</a><ul id="R-subsections-5c8cebe1226c6de44ad55152efdb64aa" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/nested/index.html" class="alwaysopen"><a class="padding" href="/publishing-with-org-mode/examples/deeply/nested/index.html">Nested …</a><ul id="R-subsections-b3d8d366e5b04e51fbfcb8de77d01482" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter1/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter1/index.html">Sub-chapter 1</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter2/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter2/index.html">Sub-chapter 2</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter3/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter3/index.html">Sub-chapter 3</a></li></ul></li></ul></li></ul></li></ul></li>
          <li data-nav-id="/license/index.html" class=""><a class="padding" href="/license/index.html">LICENSE</a></li>
          </ul>
        </div>
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVariantSwitch">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/d.rymcg.tech/whoami/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch showVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-zen-auto" value="zen-auto" selected>Zen Light/Dark</option>
                      <option id="R-select-variant-zen-light" value="zen-light">Zen Light</option>
                      <option id="R-select-variant-zen-dark" value="zen-dark">Zen Dark</option>
                      <option id="R-select-variant-relearn-auto" value="relearn-auto">Relearn Light/Dark</option>
                      <option id="R-select-variant-relearn-light" value="relearn-light">Relearn Light</option>
                      <option id="R-select-variant-relearn-dark" value="relearn-dark">Relearn Dark</option>
                      <option id="R-select-variant-relearn-bright" value="relearn-bright">Relearn Bright</option>
                      <option id="R-select-variant-neon" value="neon">Neon</option>
                      <option id="R-select-variant-learn" value="learn">Learn</option>
                      <option id="R-select-variant-blue" value="blue">Blue</option>
                      <option id="R-select-variant-green" value="green">Green</option>
                      <option id="R-select-variant-red" value="red">Red</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">Build: Jun 8, 2024 at 2:57am (UTC)

          </div>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1717815449" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1717815449" defer></script>
    <script src="/js/theme.js?1717815449" defer></script>
  </body>
</html>
