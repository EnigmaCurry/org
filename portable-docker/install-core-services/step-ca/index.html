<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.123.7">
    <meta name="generator" content="Relearn 6.0.0+tip">
    <meta name="description" content="Mutual TLS (mTLS) is a form of transport security where both the client and server authenticate each other using digital certificates. Unlike traditional TLS (e.g., Let’s Encrypt), where only the server’s identity is verified, mTLS provides mutual verification of the server and client, making it ideal for protecting data exchanges in interconnected environments like microservices and zero-trust architectures. By using certificates issued by trusted Certificate Authorities (CA), mTLS prevents unauthorized access and guarantees that both parties using a communication channel are legitimate.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Step-CA (mutual TLS) :: book.rymcg.tech">
    <meta name="twitter:description" content="Mutual TLS (mTLS) is a form of transport security where both the client and server authenticate each other using digital certificates. Unlike traditional TLS (e.g., Let’s Encrypt), where only the server’s identity is verified, mTLS provides mutual verification of the server and client, making it ideal for protecting data exchanges in interconnected environments like microservices and zero-trust architectures. By using certificates issued by trusted Certificate Authorities (CA), mTLS prevents unauthorized access and guarantees that both parties using a communication channel are legitimate.">
    <meta property="og:url" content="https://book.rymcg.tech/portable-docker/install-core-services/step-ca/index.html">
    <meta property="og:site_name" content="book.rymcg.tech">
    <meta property="og:title" content="Step-CA (mutual TLS) :: book.rymcg.tech">
    <meta property="og:description" content="Mutual TLS (mTLS) is a form of transport security where both the client and server authenticate each other using digital certificates. Unlike traditional TLS (e.g., Let’s Encrypt), where only the server’s identity is verified, mTLS provides mutual verification of the server and client, making it ideal for protecting data exchanges in interconnected environments like microservices and zero-trust architectures. By using certificates issued by trusted Certificate Authorities (CA), mTLS prevents unauthorized access and guarantees that both parties using a communication channel are legitimate.">
    <meta property="og:locale" content="en-us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Portable Docker: Build and Deploy Anywhere with WireGuard Tunneling">
    <meta itemprop="name" content="Step-CA (mutual TLS) :: book.rymcg.tech">
    <meta itemprop="description" content="Mutual TLS (mTLS) is a form of transport security where both the client and server authenticate each other using digital certificates. Unlike traditional TLS (e.g., Let’s Encrypt), where only the server’s identity is verified, mTLS provides mutual verification of the server and client, making it ideal for protecting data exchanges in interconnected environments like microservices and zero-trust architectures. By using certificates issued by trusted Certificate Authorities (CA), mTLS prevents unauthorized access and guarantees that both parties using a communication channel are legitimate.">
    <meta itemprop="wordCount" content="1892">
    <title>Step-CA (mutual TLS) :: book.rymcg.tech</title>
    <link href="/css/fontawesome-all.min.css?1729381592" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1729381592" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1729381592" rel="stylesheet">
    <link href="/css/auto-complete.css?1729381592" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1729381592" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1729381592" rel="stylesheet">
    <link href="/css/fonts.css?1729381592" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1729381592" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1729381592" rel="stylesheet">
    <link href="/css/theme-zen-auto.css?1729381592" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-zen-auto.css?1729381592" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/variant.css?1729381592" rel="stylesheet">
    <link href="/css/print.css?1729381592" rel="stylesheet" media="print">
    <script src="/js/variant.js?1729381592"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='https:\/\/book.rymcg.tech';
      window.index_js_url="/index.search.js";
      // variant stuff
      window.variants && variants.init( [ 'zen-auto', 'zen-light', 'zen-dark', 'relearn-auto', 'relearn-light', 'relearn-dark', 'relearn-bright', 'neon', 'learn', 'blue', 'green', 'red' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script><link href="/css/custom.css" rel="stylesheet">

  </head>
  <body class="mobile-support html" data-url="/portable-docker/install-core-services/step-ca/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper"><nav class="TableOfContents">
  <ul>
    <li><a href="#configure-step-ca">Configure Step-CA</a>
      <ul>
        <li><a href="#define-default-tls-certificate-expiration">Define default TLS certificate expiration</a></li>
      </ul>
    </li>
    <li><a href="#install-step-ca">Install Step-CA</a></li>
    <li><a href="#retrieve-the-admin-password">Retrieve the admin password</a></li>
    <li><a href="#finish-step-ca-configuration-by-restarting-the-service">Finish Step-CA configuration by restarting the service</a></li>
    <li><a href="#retrieve-the-server-ca-cert-fingerprint">Retrieve the server CA cert fingerprint:</a></li>
    <li><a href="#reconfigure-traefik">Reconfigure Traefik</a>
      <ul>
        <li><a href="#configure-traefik-for-mtls">Configure Traefik for mTLS</a></li>
      </ul>
    </li>
    <li><a href="#add-a-new-route-on-the-sentry">Add a new route on the sentry</a></li>
    <li><a href="#log-in-with-the-step-cli-client">Log in with the step-cli client</a></li>
    <li><a href="#create-certificates">Create certificates</a></li>
    <li><a href="#configure-apps-for-mtls">Configure apps for mTLS</a></li>
    <li><a href="#next-steps">Next steps</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/index.html"><span itemprop="name">book.rymcg.tech</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/portable-docker/index.html"><span itemprop="name">Portable Docker</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="/portable-docker/install-core-services/index.html"><span itemprop="name">Install core services</span></a><meta itemprop="position" content="3">&nbsp;>&nbsp;</li><li
            itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Step-CA (mutual TLS)</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/portable-docker/install-core-services/postfix-relay/index.html" title="Postfix-Relay (MTA) (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/portable-docker/install-core-services/docker-registry/index.html" title="Docker Registry (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="step-ca-mutual-tls">Step-CA (mutual TLS)</h1>

<p>Mutual TLS (mTLS) is a form of transport security where both the
client and server authenticate each other using digital certificates.
Unlike traditional TLS (e.g., Let&rsquo;s Encrypt), where only the server&rsquo;s
identity is verified, mTLS provides mutual verification of the server
and client, making it ideal for protecting data exchanges in
interconnected environments like microservices and zero-trust
architectures. By using certificates issued by trusted Certificate
Authorities (CA), mTLS prevents unauthorized access and guarantees
that both parties using a communication channel are legitimate.</p>
<figure><img src="/img/portable-docker/treasure-map.webp"/>
</figure>

<p><a href="https://smallstep.com/docs/step-ca/" rel="external" target="_blank">Step-CA</a> is an open source Certificate Authority (CA) and an Automated
Certificate Management Enviornment (ACME). You can self-host Step-CA
and use it to add secure mTLS authentication in all of your
applications and infrastructure.</p>

<div class="box notices cstyle primary">
  <div class="box-label">Info</div>
  <div class="box-content">

<p>This chapter is focused soley on enhancing client authentication with
mTLS, but it still uses the Let&rsquo;s Encrypt CA for the server
certificates. If you don&rsquo;t want to rely upon Let&rsquo;s Encrypt, and you
want to run a fully self-hosted Public Key Infrastructure (PKI) for
all of your services, please see the appendix chapter <a href="/portable-docker/appendix/private-acme/">Private ACME</a>.</p>
<p>Although primarily used for machine-to-machine communication, mTLS can
also be used in the web browser to provide strong end-user client
authentication, enhancing security for sensitive web applications.
This is an advanced topic, and will be discussed in the appendix
chapter <a href="/portable-docker/appendix/mutual-tls-for-web-and-mobile/">Mutual TLS for Web and Mobile</a>.</p>
</div>
</div>
<h2 id="configure-step-ca">Configure Step-CA</h2>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make step-ca config
</pre></code>
    </div>
</div>


<p>Set the hostname for Step-CA itself:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
STEP_CA_TRAEFIK_HOST: Enter the step-ca domain name (eg. ca.example.com)

: ca.pi.example.com
</pre>
    </div>
</div>

<p>Set the allowed list of domains to create certificates for:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
STEP_CA_AUTHORITY_POLICY_X509_ALLOW_DNS: Enter the list of allowed domain wildcards (comma separated) (eg. *.example.com,*.example.org)

: *.clients.pi.example.com
</pre>
    </div>
</div>


<div class="box notices cstyle primary">
  <div class="box-label">Info</div>
  <div class="box-content">

<p>In an earlier chapter Traefik was setup with <a href="/portable-docker/set-up-raspberry-pi/install-traefik/#configure-acme">ACME</a>. All of the
server-side applications on your Raspberry Pi already have automatic
TLS certificates issued via <a href="https://letsencrypt.org/getting-started/" rel="external" target="_blank">Let&rsquo;s Encrypt</a>, which is a free and public
CA, therfore, in this example Step-CA will not be required for any
server-side certificates. Lets Encrypt does not support requesting
client certificates, so Step-CA will be required only to create and
verify the client-side certificates (<code>*.clients.pi.example.com</code>).</p>
<p>In this mode, mTLS authentication works like this:</p>
<ul>
<li>The server will verify the client&rsquo;s certificate using the Step-CA
authority, whose root certificate must be added to the server&rsquo;s
trust store during install.</li>
<li>The client will verify the server&rsquo;s certificate using the Let&rsquo;s
Encrypt authority, whose root certificate is already widely trusted
in most operating systems factory default settings, which
simplifies installation.</li>
</ul>
<pre class="mermaid align-center ">
---
title: Mutual TLS with two separate Certificate Authorities
---
graph TD
    StepCA[Step CA]
    LetsEncrypt[Let&#39;s Encrypt CA]
    Client --&gt;|Client sends Step-CA signed cert| Server
    Server --&gt;|Server sends Let&#39;s Encrypt signed cert| Client
    Client &lt;--&gt;|Issues cert| StepCA
    Server &lt;--&gt;|Issues cert| LetsEncrypt
</pre>
<p>Theoretically you could just use Step-CA for both sides, but this
would require modifying the root certificate store on every client,
which is a risky and complex procedure, and ultimately unnecessary because
Let&rsquo;s Encrypt is already commonly trusted by all operating systems and
browsers.</p>
</div>
</div>

<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Each client certificate must have a unique name (CN) written in domain
name format (e.g., <code>foo.clients.pi.example.com</code>), but this does not
need to resolve to any IP address. Each certificate can have an
arbitrary name as long as it matches the Step-CA policy
(<code>STEP_CA_AUTHORITY_POLICY_X509_ALLOW_DNS</code>). The certificate name is
used as the transport authentication id (essentially used as a
username), and it is forwarded to your backend HTTP services through a
trusted header <code>X-Client-CN</code> for the purpose of secondary
authorization by the app itself.</p>
</div>
</div>
<h3 id="define-default-tls-certificate-expiration">Define default TLS certificate expiration</h3>
<p>By default, TLS certificates are valid for 7 days, and then must be
re-issued. You can customize the certificate durations in the config.
There are three limits defined:</p>
<ul>
<li><code>STEP_CA_AUTHORITY_CLAIMS_MIN_TLS_CERT_DURATION=5m</code> the minimum
duration a certificate may be requested for, 5 minutes by default.</li>
<li><code>STEP_CA_AUTHORITY_CLAIMS_MAX_TLS_CERT_DURATION=2160h</code> the maximum
duration a certificate may be requested for, 90 days be default.</li>
<li><code>STEP_CA_AUTHORITY_CLAIMS_DEFAULT_TLS_CERT_DURATION=168h</code> the
default duration a certificate will be issued for if the client
does not specify one, 7 days by default.</li>
</ul>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
## Increase the minimum duration to 1 day:
pi make step-ca reconfigure var=STEP_CA_AUTHORITY_CLAIMS_MIN_TLS_CERT_DURATION=24h

## Increase the maximum duration to 1 year:
pi make step-ca reconfigure var=STEP_CA_AUTHORITY_CLAIMS_MAX_TLS_CERT_DURATION=8760h

## Increase the default duration to 90 days:
pi make step-ca reconfigure var=STEP_CA_AUTHORITY_CLAIMS_DEFAULT_TLS_CERT_DURATION=2160h
</pre></code>
    </div>
</div>


<h2 id="install-step-ca">Install Step-CA</h2>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make step-ca install wait
</pre></code>
    </div>
</div>


<h2 id="retrieve-the-admin-password">Retrieve the admin password</h2>
<p>The admin password is printed in the container logs only the first
time it starts. Retrieve it by running:</p>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make step-ca logs-out | grep password
</pre></code>
    </div>
</div>



<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Save this password to a safe place, you will need it everytime you
sign a new (non-ACME) certificate.</p>
</div>
</div>
<h2 id="finish-step-ca-configuration-by-restarting-the-service">Finish Step-CA configuration by restarting the service</h2>

<div class="box notices cstyle primary">
  <div class="box-label">Important</div>
  <div class="box-content">

<p>After installation, you must restart Step-CA one more time to finish
the setup procedure. This will finalize the configuration in
<code>/home/step/config/ca.json</code>.</p>
<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
## Re-install forces the service to restart:
pi make step-ca reinstall
</pre></code>
    </div>
</div>
<p>This also has a side effect of clearing the admin password from the
logs, hope you saved it!</p>
</div>
</div>
<h2 id="retrieve-the-server-ca-cert-fingerprint">Retrieve the server CA cert fingerprint:</h2>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make step-ca inspect-fingerprint
</pre></code>
    </div>
</div>


<p>The fingerprint is the public identifier of the Step-CA root
certificate. Copy it into your clipboard for use in the next section.</p>
<h2 id="reconfigure-traefik">Reconfigure Traefik</h2>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make traefik config
</pre></code>
    </div>
</div>


<h3 id="configure-traefik-for-mtls">Configure Traefik for mTLS</h3>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
? Traefik:
> Config
  Install (make install)
  Admin
  Exit (ESC)

? Traefik Configuration:
  Traefik user
  Entrypoints (including dashboard)
> TLS certificates and authorities
  Middleware (including sentry auth)
  Advanced Routing (Layer 7 / Layer 4 / Wireguard)
  Error page template
v Logging level

? Traefik TLS config:
> Configure certificate authorities (CA)
  Configure ACME (Let's Encrypt or Step-CA)
  Configure TLS certificates (make certs)

? How do you want to configure the list of trusted Certificate Authorities (CA)?
  Use the stock list, (alpine: ca-certificates ca-certificates-bundle).
> Use the stock list, plus add my own root Step-CA certificate.
  Delete the entire list, and add my own root Step-CA certificate.
  Delete the entire list.
  Cancel / Go back.
</pre>
    </div>
</div>

<p>Enter the Step-CA endpoint URL:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
TRAEFIK_STEP_CA_ENDPOINT: Enter your Step-CA endpoint URL (eg. https://ca.example.com)

: https://ca.pi.example.com
</pre>
    </div>
</div>

<p>You will need to paste the fingerprint you copied from the last
section into the answer for the next question:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
TRAEFIK_STEP_CA_FINGERPRINT: Enter your Step-CA root CA certificate
fingerprint (eg. xxxxxxxxxxxxxxxxxxxx)

: xxxxxxxxxxxxxxxxxxxxxxxxxxxx
</pre>
    </div>
</div>

<p>Press <code>ESC</code> two times to go back to the main menu, then re-install
Traefik:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
? Traefik:
  Config
> Install (make install)
  Admin
  Exit (ESC)
</pre>
    </div>
</div>

<p>After installation, press <code>ESC</code> to quit the config tool.</p>
<h2 id="add-a-new-route-on-the-sentry">Add a new route on the sentry</h2>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on the Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
sentry make traefik config
</pre></code>
    </div>
</div>


<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
? Traefik:
> Config
  Install (make install)
  Admin
  Exit (ESC)

? Traefik Configuration:
^ Entrypoints (including dashboard)
  TLS certificates and authorities
  Middleware (including sentry auth)
> Advanced Routing (Layer 7 / Layer 4 / WireGuard)
  Error page template
  Logging level
  Access logs

? Traefik routes
> Configure layer 7 TLS proxy
  Configure layer 4 TCP/UDP proxy
  Configure wireguard VPN

? Layer 7 TLS Proxy:
  List layer 7 ingress routes
> Add new layer 7 ingress route
  Remove layer 7 ingress routes
  Disable layer 7 TLS Proxy

Enter the public domain (SNI) for the route:

: ca.pi.example.com

Enter the destination IP address to forward to:

: 10.13.16.2

Enter the destination TCP port to forward to:

: 443

> Do you want to enable Proxy Protocol for this route? Yes

## Layer 7 TLS Proxy is ENABLED.
## Configured Layer 7 Routes:
Entrypoint         Destination_address  Destination_port  Proxy_protocol
----------         -------------------  ----------------  --------------
ca.pi.example.com  10.13.16.2           443               2
</pre>
    </div>
</div>

<p>Press <code>ESC</code> three times to go back to the main menu, and re-install Traefik:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
? Traefik:
  Config
> Install (make install)
  Admin
  Exit (ESC)
</pre>
    </div>
</div>

<p>After installation, press <code>ESC</code> to quit the config tool.</p>
<h2 id="log-in-with-the-step-cli-client">Log in with the step-cli client</h2>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make step-ca client-bootstrap
</pre></code>
    </div>
</div>


<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
The root certificate has been saved in /home/pi/.step/certs/root_ca.crt.
The authority configuration has been saved in /home/pi/.step/config/defaults.json.
</pre>
    </div>
</div>

<h2 id="create-certificates">Create certificates</h2>
<p>Do this anytime you wish to create a new client certificate:</p>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make step-ca cert
</pre></code>
    </div>
</div>


<p>Enter the client certificate name (CN):</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
Enter the subject (CN) to be certified, a domain name, or a client name

: foo.clients.pi.example.com
</pre>
    </div>
</div>

<p>When signing certificates, you need to enter the step-ca root admin
passphrase, and then the certificates will be signed:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
Please enter the password to decrypt the provisioner key: xxxxx

✔ Provisioner: admin (JWK)
✔ Certificate: certs/foo.clients.pi.example.com.crt
✔ Private Key: certs/foo.clients.pi.example.com.key
</pre>
    </div>
</div>


<div class="box notices cstyle warning">
  <div class="box-label"><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div>
  <div class="box-content">

<p>The next question asks you to set a temporary passphrase to encrypt
the <code>.p12</code> formatted client key.</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
Please enter a password to encrypt the .p12 file:
</pre>
    </div>
</div>
<p><strong>The <code>p12</code> password should NOT be the same as the root CA password! It
should be a separate password that you will share with the end user,
so that they can unlock the certificate you are giving them.</strong></p>
</div>
</div>
<p>Finally you will see some details printed about the issued
certificate.</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
Certificate:
    Data:
       .....
        Validity
            Not Before: Oct 19 17:51:27 2024 UTC
            Not After : Oct 26 17:52:27 2024 UTC
        Subject: CN=foo.clients.pi.example.com
</pre>
    </div>
</div>

<p>The client certificate <code>foo</code> has been written to the <code>step-ca/certs</code>
directory (.e.g.,
<code>~/git/vendor/enigmacurry/d.rymcg.tech/step-ca/certs</code>.)</p>
<ul>
<li><code>foo.clients.pi.example.com.crt</code> This is the public
certificate for the <code>foo</code> client.</li>
<li><code>foo.clients.pi.example.com.key</code> This is the private key
for the <code>foo</code> certificate. <strong>This file is unencrypted</strong>.</li>
<li><code>foo.clients.pi.example.com.p12</code> This is also the private
key for the <code>foo</code> certificate written in a different format that is
used on some devices, this file is encrypted with the temporary
passphrase you chose and needs to be provided to the client when
installing the certificate.</li>
</ul>
<h2 id="configure-apps-for-mtls">Configure apps for mTLS</h2>
<p>For demo purposes, enable mTLS for the <code>whoami</code> service:</p>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make whoami config
</pre></code>
    </div>
</div>


<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
WHOAMI_TRAEFIK_HOST: Enter the whoami domain name (eg. whoami.example.com)

: whoami.pi.example.com

? Do you want to enable sentry authorization in front of this app (effectively making the entire site private)?
  No
  Yes, with HTTP Basic Authentication
  Yes, with Oauth2
> Yes, with Mutual TLS (mTLS)

WHOAMI_MTLS_AUTHORIZED_CERTS: Enter comma separated list of allowed client certificate names (or blank to allow all) (eg. *.clients.whoami.example.com)

: *.clients.pi.example.com
</pre>
    </div>
</div>


<div class="box notices cstyle tip">
  <div class="box-label"><i class="fa-fw fas fa-lightbulb"></i> Tip</div>
  <div class="box-content">

<p>Make sure to enter the same authorized cert wildcard that matches your
client certificate, otherwise you will encounter the error <code>No matching DNS names.</code></p>
</div>
</div>
<p>Re-install whoami:</p>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
pi make whoami install
</pre></code>
    </div>
</div>


<p>Test the service without specifying a certificate:</p>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
curl https://whoami.pi.example.com
</pre></code>
    </div>
</div>


<p>You should now receive one of the following errors, both indicating
that a client certificate is required:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
curl: (56) OpenSSL SSL_read: OpenSSL/3.0.14: error:0A00045C:SSL routines::tlsv13 alert certificate required, errno 0
curl: (55) getpeername() failed with errno 107: Transport endpoint is not connected
</pre>
    </div>
</div>

<p>Now test it with your client certificate:</p>


<div class="box notices cstyle run">
    <div class="box-label secondary">
        <i class="fa-fw fas fa-dollar-sign"></i>Run this on your Raspberry Pi</div>
    <div class="box-content">
        <code><pre>
(
NAME=foo.clients.pi.example.com
CERTS=~/git/vendor/enigmacurry/d.rymcg.tech/step-ca/certs

curl https://whoami.pi.example.com \
--cert ${CERTS}/${NAME}.crt \
--key ${CERTS}/${NAME}.key
)
</pre></code>
    </div>
</div>


<p>With the correctly supplied certificate and key, the server now
resolves to the whoami response:</p>
<div class="box notices cstyle stdout">
    <div class="box-label"><i class="fa-fw fas fa-angle-right"></i>(stdout)</div>
    <div class="box-content">
        <pre>
Name: default
Hostname: 427db0a29c30
IP: 127.0.0.1
IP: ::1
IP: 172.19.0.2
RemoteAddr: 172.19.0.1:45068
GET / HTTP/1.1
Host: whoami.pi.example.com
User-Agent: curl/7.88.1
Accept: */*
Accept-Encoding: gzip
X-Client-Cn: CN=foo.clients.pi.example.com
X-Forwarded-For: 127.0.0.1
X-Forwarded-Host: whoami.pi.example.com
X-Forwarded-Port: 443
X-Forwarded-Proto: https
X-Forwarded-Server: pi5
X-Forwarded-User: CN=foo.clients.pi.example.com
X-Real-Ip: 127.0.0.1
</pre>
    </div>
</div>

<p>Notice that there are two headers sent to the whoami backend:</p>
<ul>
<li><code>X-Client-Cn</code></li>
<li><code>X-Forwarded-User</code></li>
</ul>
<p>These two headers contain the same information, identifying the client
cert id to the backend server. Either of these may be used for
secondary authorization in your app.</p>
<h2 id="next-steps">Next steps</h2>
<ul>
<li>Install apps.</li>
</ul>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<img src="/img/logo.jpg" class="logo" />

        </div>

        <search><form action="/search.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1729381592" defer></script>
        <script src="/js/lunr/lunr.min.js?1729381592" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1729381592" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1729381592" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1729381592" defer></script>
        <script src="/js/search.js?1729381592" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <ul>
          <li><a class="padding" href="/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
        </ul>
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-topics">
          <ul class="enlarge morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/index.html" class=""><a class="padding" href="/linux-workstation/index.html">Linux Workstation</a><ul id="R-subsections-4fabcc8bf6f43bc84cc33c8d9fe1b62b" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/introduction/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/introduction/index.html">Introduction</a><ul id="R-subsections-247caeb1441bcea844a3ccf766ca4471" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/introduction/fedora-sway-atomic/index.html" class=""><a class="padding" href="/linux-workstation/introduction/fedora-sway-atomic/index.html">Fedora Sway Atomic</a></li>
          <li data-nav-id="/linux-workstation/introduction/requirements/index.html" class=""><a class="padding" href="/linux-workstation/introduction/requirements/index.html">Requirements</a></li></ul></li>
          <li data-nav-id="/linux-workstation/install/index.html" class=""><a class="padding" href="/linux-workstation/install/index.html">Install Linux (Fedora Atomic)</a></li>
          <li data-nav-id="/linux-workstation/upgrading/index.html" class=""><a class="padding" href="/linux-workstation/upgrading/index.html">Upgrading</a></li>
          <li data-nav-id="/linux-workstation/layering-packages/index.html" class=""><a class="padding" href="/linux-workstation/layering-packages/index.html">Layering packages</a></li>
          <li data-nav-id="/linux-workstation/config/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/config/index.html">Config</a><ul id="R-subsections-51edac90ba33828eb61f7465c11b4244" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/config/sway/index.html" class=""><a class="padding" href="/linux-workstation/config/sway/index.html">Sway</a></li>
          <li data-nav-id="/linux-workstation/config/firefox/index.html" class=""><a class="padding" href="/linux-workstation/config/firefox/index.html">Firefox</a></li>
          <li data-nav-id="/linux-workstation/config/toolbox/index.html" class=""><a class="padding" href="/linux-workstation/config/toolbox/index.html">Toolbox</a></li>
          <li data-nav-id="/linux-workstation/config/emacs-on-fedora/index.html" class=""><a class="padding" href="/linux-workstation/config/emacs-on-fedora/index.html">Emacs</a></li>
          <li data-nav-id="/linux-workstation/config/ssh/index.html" class=""><a class="padding" href="/linux-workstation/config/ssh/index.html">SSH</a></li></ul></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/sudo-2fa/index.html">Solokey authentication</a><ul id="R-subsections-96e2330197c57518ec319a4d358386d1" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/sudo-2fa/get-your-solokey/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/get-your-solokey/index.html">Get your Solokey</a></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/solo-v2/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/solo-v2/index.html">Solokey v2</a></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/solo-v1/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/solo-v1/index.html">Solokey v1</a></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/sudo-2fa/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/sudo-2fa/index.html">Sudo with Solokey</a></li>
          <li data-nav-id="/linux-workstation/sudo-2fa/ssh-2fa/index.html" class=""><a class="padding" href="/linux-workstation/sudo-2fa/ssh-2fa/index.html">SSH with Solokey</a></li></ul></li>
          <li data-nav-id="/linux-workstation/app-users/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/app-users/index.html">Application users</a><ul id="R-subsections-f5664fb1bd37f091399ca1d7ccc19fa6" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/app-users/digitalocean/index.html" class=""><a class="padding" href="/linux-workstation/app-users/digitalocean/index.html">DigitalOcean CLI (doctl)</a></li></ul></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/kvm-libvirt/index.html">KVM / libvirt</a><ul id="R-subsections-866ef10ce7233c8e220552c62acdd9fb" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/kvm-libvirt/install-libvirtd/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/install-libvirtd/index.html">Install libvirtd</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/setup-libvirtd/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/setup-libvirtd/index.html">Setup libvirtd</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/dedicated-vm-user/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/dedicated-vm-user/index.html">Create VM admin</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/cloud-init/index.html" class="alwaysopen"><a class="padding" href="/linux-workstation/kvm-libvirt/cloud-init/index.html">Cloud-Init VMs</a><ul id="R-subsections-85e75632117660d261346e27d0e1596a" class="morespace collapsible-menu">
          <li data-nav-id="/linux-workstation/kvm-libvirt/cloud-init/config-vm/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/cloud-init/config-vm/index.html">Configure VM (cloud-init)</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/cloud-init/create-vm/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/cloud-init/create-vm/index.html">Create VM (cloud-init)</a></li></ul></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/systemd/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/systemd/index.html">Systemd services to control VMs</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/public-routes/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/public-routes/index.html">Public routes to VMs</a></li>
          <li data-nav-id="/linux-workstation/kvm-libvirt/setup-workstation/index.html" class=""><a class="padding" href="/linux-workstation/kvm-libvirt/setup-workstation/index.html">Setup workstation SSH config</a></li></ul></li>
          <li data-nav-id="/linux-workstation/firewall/index.html" class=""><a class="padding" href="/linux-workstation/firewall/index.html">Firewall</a></li></ul></li>
          <li data-nav-id="/portable-docker/index.html" class="parent "><a class="padding" href="/portable-docker/index.html">Portable Docker</a><ul id="R-subsections-b3086ba332f3435644ca357f0652e978" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/acknowledgements/index.html" class=""><a class="padding" href="/portable-docker/acknowledgements/index.html">Acknowledgements</a></li>
          <li data-nav-id="/portable-docker/introduction/index.html" class=""><a class="padding" href="/portable-docker/introduction/index.html">Introduction</a></li>
          <li data-nav-id="/portable-docker/set-up-dns/index.html" class="alwaysopen"><a class="padding" href="/portable-docker/set-up-dns/index.html">Set up DNS</a><ul id="R-subsections-a0c2c97983f01b68076939714fc6a926" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/set-up-dns/register-domain/index.html" class=""><a class="padding" href="/portable-docker/set-up-dns/register-domain/index.html">Register a domain name</a></li>
          <li data-nav-id="/portable-docker/set-up-dns/create-digitalocean-api-token/index.html" class=""><a class="padding" href="/portable-docker/set-up-dns/create-digitalocean-api-token/index.html">Add the domain to DigitalOcean DNS</a></li>
          <li data-nav-id="/portable-docker/set-up-dns/create-digitalocean-api-token-for-acme-challenge/index.html" class=""><a class="padding" href="/portable-docker/set-up-dns/create-digitalocean-api-token-for-acme-challenge/index.html">Generate DigitalOcean API token for ACME challenge</a></li></ul></li>
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/index.html" class="alwaysopen"><a class="padding" href="/portable-docker/set-up-raspberry-pi/index.html">Set up Raspberry Pi</a><ul id="R-subsections-76f5fc887c0761353199079afdcded3c" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/build-your-pi/index.html" class=""><a class="padding" href="/portable-docker/set-up-raspberry-pi/build-your-pi/index.html">Build your Raspberry Pi</a></li>
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/install-raspbian/index.html" class=""><a class="padding" href="/portable-docker/set-up-raspberry-pi/install-raspbian/index.html">Install Raspberry Pi OS</a></li>
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/set-up-networking/index.html" class=""><a class="padding" href="/portable-docker/set-up-raspberry-pi/set-up-networking/index.html">Set up networking</a></li>
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/set-up-ssh/index.html" class=""><a class="padding" href="/portable-docker/set-up-raspberry-pi/set-up-ssh/index.html">Set up SSH</a></li>
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/install-docker/index.html" class=""><a class="padding" href="/portable-docker/set-up-raspberry-pi/install-docker/index.html">Install Docker</a></li>
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/install-d-rymcg-tech/index.html" class=""><a class="padding" href="/portable-docker/set-up-raspberry-pi/install-d-rymcg-tech/index.html">Install d.rymcg.tech</a></li>
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/install-traefik/index.html" class=""><a class="padding" href="/portable-docker/set-up-raspberry-pi/install-traefik/index.html">Install Traefik</a></li>
          <li data-nav-id="/portable-docker/set-up-raspberry-pi/install-whoami/index.html" class=""><a class="padding" href="/portable-docker/set-up-raspberry-pi/install-whoami/index.html">Install Whoami</a></li></ul></li>
          <li data-nav-id="/portable-docker/set-up-cloud-sentry/index.html" class="alwaysopen"><a class="padding" href="/portable-docker/set-up-cloud-sentry/index.html">Set up sentry Droplet</a><ul id="R-subsections-d79aafc309d8cfcdaa8648ffd061e5e1" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/set-up-cloud-sentry/launch-digitalocean-droplet/index.html" class=""><a class="padding" href="/portable-docker/set-up-cloud-sentry/launch-digitalocean-droplet/index.html">Launch DigitalOcean droplet</a></li>
          <li data-nav-id="/portable-docker/set-up-cloud-sentry/set-up-docker-context/index.html" class=""><a class="padding" href="/portable-docker/set-up-cloud-sentry/set-up-docker-context/index.html">Configure the sentry context on the Pi</a></li>
          <li data-nav-id="/portable-docker/set-up-cloud-sentry/configure-d-rymcg-tech-for-sentry/index.html" class=""><a class="padding" href="/portable-docker/set-up-cloud-sentry/configure-d-rymcg-tech-for-sentry/index.html">Configure d.rymcg.tech for the sentry</a></li></ul></li>
          <li data-nav-id="/portable-docker/configure-wireguard-tunnel/index.html" class="alwaysopen"><a class="padding" href="/portable-docker/configure-wireguard-tunnel/index.html">Configure WireGuard VPN</a><ul id="R-subsections-0f57b4569cb5c84faed570bffcdf4dd0" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/configure-wireguard-tunnel/configure-sentry-wireguard-server/index.html" class=""><a class="padding" href="/portable-docker/configure-wireguard-tunnel/configure-sentry-wireguard-server/index.html">Configure sentry wireguard server</a></li>
          <li data-nav-id="/portable-docker/configure-wireguard-tunnel/configure-raspberry-pi-wireguard-client/index.html" class=""><a class="padding" href="/portable-docker/configure-wireguard-tunnel/configure-raspberry-pi-wireguard-client/index.html">Configure Raspberry Pi WireGuard client</a></li></ul></li>
          <li data-nav-id="/portable-docker/set-up-public-ssh-reverse-tunnel/index.html" class=""><a class="padding" href="/portable-docker/set-up-public-ssh-reverse-tunnel/index.html">Set up public SSH</a></li>
          <li data-nav-id="/portable-docker/install-core-services/index.html" class="parent alwaysopen"><a class="padding" href="/portable-docker/install-core-services/index.html">Install core services</a><ul id="R-subsections-c9481aa00498efbc9aa9b90ebe7fdb65" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/install-core-services/forgejo/index.html" class=""><a class="padding" href="/portable-docker/install-core-services/forgejo/index.html">Forgejo</a></li>
          <li data-nav-id="/portable-docker/install-core-services/traefik-forward-auth/index.html" class=""><a class="padding" href="/portable-docker/install-core-services/traefik-forward-auth/index.html">Traefik-Forward-Auth (sentry authorization)</a></li>
          <li data-nav-id="/portable-docker/install-core-services/postfix-relay/index.html" class=""><a class="padding" href="/portable-docker/install-core-services/postfix-relay/index.html">Postfix-Relay (MTA)</a></li>
          <li data-nav-id="/portable-docker/install-core-services/step-ca/index.html" class="active"><a class="padding" href="/portable-docker/install-core-services/step-ca/index.html">Step-CA (mutual TLS)</a></li>
          <li data-nav-id="/portable-docker/install-core-services/docker-registry/index.html" class=""><a class="padding" href="/portable-docker/install-core-services/docker-registry/index.html">Docker Registry</a></li></ul></li>
          <li data-nav-id="/portable-docker/install-web-services/index.html" class="alwaysopen"><a class="padding" href="/portable-docker/install-web-services/index.html">Install apps</a><ul id="R-subsections-4340db93b595b617ec6a0c5b45298ba3" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/install-web-services/immich/index.html" class=""><a class="padding" href="/portable-docker/install-web-services/immich/index.html">Immich</a></li>
          <li data-nav-id="/portable-docker/install-web-services/sftp/index.html" class=""><a class="padding" href="/portable-docker/install-web-services/sftp/index.html">SFTP (and Thttpd)</a></li>
          <li data-nav-id="/portable-docker/install-web-services/minio-s3/index.html" class=""><a class="padding" href="/portable-docker/install-web-services/minio-s3/index.html">MinIO S3 (and Filestash)</a></li>
          <li data-nav-id="/portable-docker/install-web-services/homepage/index.html" class=""><a class="padding" href="/portable-docker/install-web-services/homepage/index.html">Homepage</a></li>
          <li data-nav-id="/portable-docker/install-web-services/yourls/index.html" class=""><a class="padding" href="/portable-docker/install-web-services/yourls/index.html">Yourls</a></li>
          <li data-nav-id="/portable-docker/install-web-services/nginx-and-php/index.html" class=""><a class="padding" href="/portable-docker/install-web-services/nginx-and-php/index.html">Nginx and PHP</a></li>
          <li data-nav-id="/portable-docker/install-web-services/jupyterlab/index.html" class=""><a class="padding" href="/portable-docker/install-web-services/jupyterlab/index.html">Jupyterlab</a></li></ul></li>
          <li data-nav-id="/portable-docker/maintainence/index.html" class="alwaysopen"><a class="padding" href="/portable-docker/maintainence/index.html">Maintainence</a><ul id="R-subsections-81d31540667f3eb173271408fccd3717" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/maintainence/backup/index.html" class=""><a class="padding" href="/portable-docker/maintainence/backup/index.html">Native Backup</a></li>
          <li data-nav-id="/portable-docker/maintainence/upgrade/index.html" class=""><a class="padding" href="/portable-docker/maintainence/upgrade/index.html">Upgrade</a></li>
          <li data-nav-id="/portable-docker/maintainence/troubleshooting/index.html" class=""><a class="padding" href="/portable-docker/maintainence/troubleshooting/index.html">Troubleshooting</a></li></ul></li>
          <li data-nav-id="/portable-docker/appendix/index.html" class="alwaysopen"><a class="padding" href="/portable-docker/appendix/index.html">Appendix</a><ul id="R-subsections-be574699630779575805aef573eb3b88" class="morespace collapsible-menu">
          <li data-nav-id="/portable-docker/appendix/private-acme/index.html" class=""><a class="padding" href="/portable-docker/appendix/private-acme/index.html">Private ACME</a></li>
          <li data-nav-id="/portable-docker/appendix/mutual-tls-for-web-and-mobile/index.html" class=""><a class="padding" href="/portable-docker/appendix/mutual-tls-for-web-and-mobile/index.html">Mutual TLS for Web and Mobile</a></li></ul></li></ul></li>
          <li data-nav-id="/publishing-with-org-mode/index.html" class=""><a class="padding" href="/publishing-with-org-mode/index.html">Publishing with org-mode</a><ul id="R-subsections-415a59a995a98556d7692b05dd8d304c" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/dependencies/index.html" class=""><a class="padding" href="/publishing-with-org-mode/dependencies/index.html">Dependencies</a></li>
          <li data-nav-id="/publishing-with-org-mode/building-locally/index.html" class=""><a class="padding" href="/publishing-with-org-mode/building-locally/index.html">Building locally</a></li>
          <li data-nav-id="/publishing-with-org-mode/publish-with-github-pages/index.html" class=""><a class="padding" href="/publishing-with-org-mode/publish-with-github-pages/index.html">Publishing with GitHub pages</a></li>
          <li data-nav-id="/publishing-with-org-mode/publish-with-sftp/index.html" class=""><a class="padding" href="/publishing-with-org-mode/publish-with-sftp/index.html">Publishing with SFTP</a></li>
          <li data-nav-id="/publishing-with-org-mode/org-mode-emacs/index.html" class="alwaysopen"><a class="padding" href="/publishing-with-org-mode/org-mode-emacs/index.html">Using Org-mode and Emacs</a><ul id="R-subsections-f93c6166e26669592c85e9cf02707646" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/org-mode-emacs/navigating-org-mode/index.html" class=""><a class="padding" href="/publishing-with-org-mode/org-mode-emacs/navigating-org-mode/index.html">Navigating Org-mode files</a></li>
          <li data-nav-id="/publishing-with-org-mode/org-mode-emacs/editing-org-mode/index.html" class=""><a class="padding" href="/publishing-with-org-mode/org-mode-emacs/editing-org-mode/index.html">Editing Org-mode files</a></li></ul></li>
          <li data-nav-id="/publishing-with-org-mode/examples/index.html" class="alwaysopen"><a class="padding" href="/publishing-with-org-mode/examples/index.html">Example Org / Hugo content</a><ul id="R-subsections-21525f33c1956ce3844918973388ff0a" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/examples/org-blocks/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/org-blocks/index.html">Example Org Blocks</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/shortcodes/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/shortcodes/index.html">Example Shortcodes</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/index.html" class="alwaysopen"><a class="padding" href="/publishing-with-org-mode/examples/deeply/index.html">Example of a deeply …</a><ul id="R-subsections-5c8cebe1226c6de44ad55152efdb64aa" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/nested/index.html" class="alwaysopen"><a class="padding" href="/publishing-with-org-mode/examples/deeply/nested/index.html">Nested …</a><ul id="R-subsections-b3d8d366e5b04e51fbfcb8de77d01482" class="morespace collapsible-menu">
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter1/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter1/index.html">Sub-chapter 1</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter2/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter2/index.html">Sub-chapter 2</a></li>
          <li data-nav-id="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter3/index.html" class=""><a class="padding" href="/publishing-with-org-mode/examples/deeply/nested/subchapters/subchapter3/index.html">Sub-chapter 3</a></li></ul></li></ul></li></ul></li></ul></li>
          <li data-nav-id="/license/index.html" class=""><a class="padding" href="/license/index.html">LICENSE</a></li>
          </ul>
        </div>
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVariantSwitch showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVariantSwitch">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/portable-docker/install-core-services/step-ca/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch showVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-zen-auto" value="zen-auto" selected>Zen Light/Dark</option>
                      <option id="R-select-variant-zen-light" value="zen-light">Zen Light</option>
                      <option id="R-select-variant-zen-dark" value="zen-dark">Zen Dark</option>
                      <option id="R-select-variant-relearn-auto" value="relearn-auto">Relearn Light/Dark</option>
                      <option id="R-select-variant-relearn-light" value="relearn-light">Relearn Light</option>
                      <option id="R-select-variant-relearn-dark" value="relearn-dark">Relearn Dark</option>
                      <option id="R-select-variant-relearn-bright" value="relearn-bright">Relearn Bright</option>
                      <option id="R-select-variant-neon" value="neon">Neon</option>
                      <option id="R-select-variant-learn" value="learn">Learn</option>
                      <option id="R-select-variant-blue" value="blue">Blue</option>
                      <option id="R-select-variant-green" value="green">Green</option>
                      <option id="R-select-variant-red" value="red">Red</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">Build: Oct 19, 2024 at 11:46pm (UTC)

          </div>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1729381592" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-color.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-drag.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-ease.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-selection.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-timer.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-transition.min.js?1729381592" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1729381592" defer></script>
    <script src="/js/js-yaml.min.js?1729381592" defer></script>
    <script src="/js/mermaid.min.js?1729381592" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1729381592" defer></script>
  </body>
</html>
